name: Executar Script Cliente TROPA

on:
  schedule:
    - cron: "0 10 * * *" # Executa diariamente às 10:00 UTC (07:00 no Brasil)
  workflow_dispatch: # Permite execução manual

jobs:
  executar-script-tropa:
    runs-on: ubuntu-latest

    steps:
      - name: Clonar Repositório
        uses: actions/checkout@v3

      - name: Configurar Python
        uses: actions/setup-python@v3
        with:
          python-version: "3.11"

      - name: Instalar Dependências
        run: pip install -r requirements.txt

      - name: Criar Credenciais Temporárias do Google
        env:
          GOOGLE_CREDENTIALS: ${{ secrets.GOOGLE_CREDENTIALS }}
        run: echo "$GOOGLE_CREDENTIALS" > automacao-meta-ads.json

      - name: Executar Script Cliente TROPA
        env:
          GOOGLE_SHEET_ID: ${{ secrets.GOOGLE_SHEET_ID_TROPA }}
          GOOGLE_SHEET_TAB: ${{ secrets.GOOGLE_SHEET_TAB_TROPA }}
          META_ACCESS_TOKEN: ${{ secrets.META_ACCESS_TOKEN }}
        run: python clientes/CA_TROPA/script_tropa.py

      - name: Registrar Log no GitHub
        if: always()
        run: |
          echo "$(date) - Cliente TROPA - Workflow 
